<!DOCTYPE html>
<html>
<head>
    <title>üöÄ UI OpenVPN Linux - Navegador Espacial</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%);
            color: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo {
            width: 100px;
            height: 100px;
            margin: 0 auto 20px;
            display: block;
            filter: drop-shadow(0 0 20px rgba(0, 150, 255, 0.3));
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="40" fill="%2300d4ff"/><path d="M30 50 L45 35 L45 45 L70 45 L70 55 L45 55 L45 65 Z" fill="white"/></svg>') center/contain no-repeat;
        }
        
        h1 { 
            color: #00d4ff; 
            text-align: center;
            font-size: 2.5em;
            margin: 0;
            text-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        .subtitle {
            color: #888;
            text-align: center;
            font-size: 1.1em;
            margin-top: 10px;
        }
        
        .status { 
            padding: 15px; 
            border-radius: 15px; 
            margin: 20px 0;
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .connected { 
            background: linear-gradient(45deg, #00ff88, #00cc66);
            color: #003d1a;
            border-color: #00ff88;
            box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
        }
        
        .disconnected { 
            background: linear-gradient(45deg, #ff4757, #ff3742);
            color: #fff;
            border-color: #ff4757;
            box-shadow: 0 0 20px rgba(255, 71, 87, 0.3);
        }
        
        .vpn-list { 
            border: 1px solid rgba(0, 212, 255, 0.3); 
            border-radius: 15px;
            max-height: 300px;
            overflow-y: auto;
            background: rgba(0, 0, 0, 0.2);
            backdrop-filter: blur(5px);
            margin: 20px 0;
        }
        
        .vpn-item { 
            padding: 15px; 
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1em;
        }
        
        .vpn-item:hover { 
            background: rgba(0, 212, 255, 0.1);
            transform: translateX(5px);
        }
        
        .vpn-item.selected { 
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: white;
            box-shadow: 0 0 15px rgba(0, 212, 255, 0.4);
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        button { 
            padding: 12px 24px; 
            border: 2px solid transparent; 
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-shadow: 0 0 5px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary { 
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: white;
            border-color: #00d4ff;
            box-shadow: 0 4px 15px rgba(0, 212, 255, 0.4);
        }
        
        .btn-success { 
            background: linear-gradient(45deg, #00ff88, #00cc66);
            color: #003d1a;
            border-color: #00ff88;
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.4);
        }
        
        .btn-danger { 
            background: linear-gradient(45deg, #ff4757, #ff3742);
            color: white;
            border-color: #ff4757;
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.4);
        }
        
        .btn-secondary { 
            background: linear-gradient(45deg, #747d8c, #57606f);
            color: white;
            border-color: #747d8c;
            box-shadow: 0 4px 15px rgba(116, 125, 140, 0.4);
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        button:disabled { 
            opacity: 0.5; 
            cursor: not-allowed; 
            transform: none;
        }
        
        .message { 
            padding: 15px; 
            margin: 15px 0;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
        }
        
        .success { 
            background: linear-gradient(45deg, #00ff88, #00cc66);
            color: #003d1a;
            box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
        }
        
        .error { 
            background: linear-gradient(45deg, #ff4757, #ff3742);
            color: #fff;
            box-shadow: 0 0 15px rgba(255, 71, 87, 0.3);
        }
        
        h3 {
            color: #00d4ff;
            margin-bottom: 15px;
            text-shadow: 0 0 5px rgba(0, 212, 255, 0.5);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #888;
            font-size: 1.1em;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo"></div>
            <h1>UI OpenVPN Linux</h1>
            <div class="subtitle">üöÄ Navegador Espacial de Conexiones VPN ‚ú®</div>
        </div>
        
        <div id="status" class="status disconnected">
            üî¥ Desconectado del Ciberespacio
        </div>
        
        <div id="message"></div>
        
        <h3>üåå Estaciones VPN Disponibles</h3>
        <div id="vpn-list" class="vpn-list">
            <div class="loading">
                üîÑ Explorando el ciberespacio...
            </div>
        </div>
        
        <div class="buttons">
            <button id="refresh-btn" class="btn-secondary">üîÑ Explorar Estaciones</button>
            <button id="connect-btn" class="btn-success" disabled>üöÄ Conectar</button>
            <button id="disconnect-btn" class="btn-danger">üõë Desconectar</button>
            <button id="import-btn" class="btn-primary">üì• Importar VPN</button>
        </div>
    </div>

    <script type="module">
        // Import Tauri API
        import { invoke } from 'https://unpkg.com/@tauri-apps/api@2/core'
        import { open } from 'https://unpkg.com/@tauri-apps/api@2/dialog'
        
        let selectedVpn = null;
        
        async function loadVpns() {
            try {
                const vpns = await invoke('list_vpn_connections');
                
                const listDiv = document.getElementById('vpn-list');
                if (vpns.length === 0) {
                    listDiv.innerHTML = '<div style="padding: 20px; text-align: center; color: #888;">üåå No hay estaciones disponibles<br><small>Importa un archivo .ovpn para comenzar</small></div>';
                    return;
                }
                
                listDiv.innerHTML = vpns.map(vpn => 
                    `<div class="vpn-item" onclick="selectVpn('${vpn.name}')">
                        üõ∞Ô∏è ${vpn.name}
                    </div>`
                ).join('');
            } catch (error) {
                showMessage('Error cargando VPNs: ' + error, 'error');
                console.error('Error:', error);
            }
        }
        
        async function loadStatus() {
            try {
                const status = await invoke('get_vpn_status');
                
                const statusDiv = document.getElementById('status');
                if (status.connected) {
                    statusDiv.className = 'status connected';
                    statusDiv.innerHTML = `üöÄ Navegando desde estaci√≥n: ${status.active_vpn}`;
                } else {
                    statusDiv.className = 'status disconnected';
                    statusDiv.innerHTML = 'üî¥ Desconectado del Ciberespacio';
                }
            } catch (error) {
                showMessage('Error obteniendo estado: ' + error, 'error');
                console.error('Error:', error);
            }
        }
        
        window.selectVpn = function(name) {
            selectedVpn = name;
            document.querySelectorAll('.vpn-item').forEach(item => {
                item.classList.remove('selected');
            });
            event.target.classList.add('selected');
            document.getElementById('connect-btn').disabled = false;
        }
        
        async function connectVpn() {
            if (!selectedVpn) return;
            
            try {
                const result = await invoke('connect_vpn', { name: selectedVpn });
                showMessage(result.message, result.success ? 'success' : 'error');
                setTimeout(() => loadStatus(), 1000);
            } catch (error) {
                showMessage('Error conectando: ' + error, 'error');
                console.error('Error:', error);
            }
        }
        
        async function disconnectVpn() {
            try {
                const result = await invoke('disconnect_vpn');
                showMessage(result.message, result.success ? 'success' : 'error');
                setTimeout(() => loadStatus(), 1000);
            } catch (error) {
                showMessage('Error desconectando: ' + error, 'error');
                console.error('Error:', error);
            }
        }
        
        async function importVpn() {
            try {
                const filePath = await open({
                    title: 'Seleccionar archivo .ovpn',
                    multiple: false,
                    filters: [{
                        name: 'OpenVPN Files',
                        extensions: ['ovpn']
                    }]
                });
                
                if (filePath) {
                    const result = await invoke('import_vpn_file', { filePath });
                    showMessage(result.message, result.success ? 'success' : 'error');
                    
                    if (result.success) {
                        setTimeout(() => loadVpns(), 1000);
                    }
                }
            } catch (error) {
                showMessage('Error importando archivo: ' + error, 'error');
                console.error('Error:', error);
            }
        }
        
        function showMessage(text, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.className = `message ${type}`;
            messageDiv.textContent = text;
            setTimeout(() => messageDiv.innerHTML = '', 3000);
        }
        
        function refresh() {
            loadVpns();
            loadStatus();
        }
        
        // Event listeners
        document.getElementById('refresh-btn').onclick = refresh;
        document.getElementById('connect-btn').onclick = connectVpn;
        document.getElementById('disconnect-btn').onclick = disconnectVpn;
        document.getElementById('import-btn').onclick = importVpn;
        
        // Cargar datos iniciales
        refresh();
        
        // Auto-refresh cada 10 segundos
        setInterval(loadStatus, 10000);
    </script>
</body>
</html>